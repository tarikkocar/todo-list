(()=>{"use strict";class t{constructor(t,e,s="medium",i="incomplete"){this.title=t,this.dueDate=e,this.priority=s,this.status=i}markComplete(){this.status="completed"}markIncomplete(){this.status="incomplete"}}class e{constructor(t){this.title=t,this.tasks=[]}addTask(e){this.tasks.push(new t(e))}deleteTask(t){const e=this.tasks.indexOf(t);e>-1&&this.tasks.splice(e,1)}getTasks(){return this.tasks}}class s{constructor(){this.projects=[],this.projects.push(new e("Home")),this.projects.push(new e("Today")),this.projects.push(new e("This week"))}addProject(t){this.projects.push(new e(t))}deleteProject(t){const e=this.projects.indexOf(t);e>-1&&this.projects.splice(e,1)}getProjects(){return this.projects}}(new class{constructor(){this.toDoList=new s,this.currentProjectIndex=0,this.basicItems=document.querySelector(".basic-items"),this.projectList=document.querySelector(".project-list"),this.addProjectBtn=document.querySelector(".add-project-btn"),this.taskList=document.querySelector(".task-list"),this.addTaskBtn=document.querySelector(".add-task-btn")}loadHomePage(){this.displayTasks(this.currentProjectIndex),this.handleLeftPaneAnimation(this.currentProjectIndex),this.addPageEventListeners()}displayProjects(){const t=this.toDoList.getProjects();this.projectList.innerHTML="";for(let e=0;e<t.length;e++)if("Home"!==t[e].title&&"Today"!==t[e].title&&"This week"!==t[e].title){const s=document.createTextNode(t[e].title),i=document.createElement("li");i.dataset.index=e,i.appendChild(s),this.projectList.appendChild(i)}}createProject(){const t=this.projectList.querySelector(".new-project-input");if(t)return void t.focus();const e=document.createElement("input");e.setAttribute("type","text"),e.setAttribute("placeholder","Project name"),e.classList.add("new-project-input");const s=document.createElement("li");s.appendChild(e),this.projectList.appendChild(s),e.focus(),e.addEventListener("keydown",(t=>{const i=e.value.trim();if(i&&"Enter"===t.key){this.toDoList.addProject(i),this.displayProjects();const t=this.toDoList.projects.length-1;this.displayTasks(t),this.handleLeftPaneAnimation(t),s.remove()}else"Escape"===t.key&&s.remove()}))}displayTasks(t){this.currentProjectIndex=t;const e=this.toDoList.getProjects()[t].getTasks();this.taskList.innerHTML="";for(let t=0;t<e.length;t++){const s=document.createElement("div");s.classList.add("task"),s.classList.add(`${e[t].priority}-priority`),s.classList.add(`${e[t].status}`);const i=document.createElement("input");i.setAttribute("type","checkbox"),i.classList.add("task-checkbox"),i.checked="completed"===e[t].status;const a=document.createElement("span");a.classList.add("task-name");const n=document.createTextNode(`${e[t].title}`);a.appendChild(n);const d=document.createElement("img");d.setAttribute("src","../src/images/edit.svg"),d.classList.add("task-edit");const c=document.createElement("button");c.classList.add("task-delete");const r=document.createTextNode("X");if(c.appendChild(r),s.appendChild(i),s.appendChild(a),s.appendChild(d),s.appendChild(c),e[t].dueDate){const s=document.createElement("span");s.classList.add("due-date"),s.innerHTML=e[t].dueDate,a.insertAdjacentElement("afterend",s)}this.taskList.appendChild(s),this.addTaskEventListeners(s,e[t])}1===this.currentProjectIndex|2===this.currentProjectIndex?this.addTaskBtn.classList.add("hidden"):this.addTaskBtn.classList.remove("hidden")}displayDatedTasks(t){this.currentProjectIndex=t,this.toDoList.getProjects()[0].getTasks()}createTask(){const t=this.taskList.querySelector(".task-input");if(t)return void t.focus();const e=document.createElement("input");e.setAttribute("type","text"),e.setAttribute("placeholder","Task title"),e.classList.add("task-input");const s=document.createElement("div");s.appendChild(e),this.taskList.appendChild(s),e.focus(),e.addEventListener("keydown",(t=>{const i=e.value.trim();i&&"Enter"===t.key?(this.toDoList.getProjects()[this.currentProjectIndex].addTask(i),this.displayTasks(this.currentProjectIndex),s.remove()):"Escape"===t.key&&s.remove()}))}handleLeftPaneAnimation(t){document.querySelectorAll(".basic-items li, .project-list li").forEach(((e,s)=>{s===t?e.classList.add("active"):e.classList.remove("active")}))}showForm(t,e){const s=t.querySelector(".task-name"),i=t.querySelector(".due-date"),a=document.createElement("form"),n=document.createElement("input"),d=document.createElement("input"),c=document.createElement("button"),r=document.createElement("div");a.setAttribute("action","#"),n.setAttribute("type","text"),n.classList.add("task-edit-input"),d.setAttribute("type","date"),d.classList.add("task-date"),c.setAttribute("type","button"),c.innerHTML="Save",r.classList.add("priority-area"),r.innerHTML="<div class= 'low-priority-btn'><input type='radio' id='low' name='priority'><label for='low'>Low</label></div><div class='medium-priority-btn'><input type='radio' id='medium' name='priority'><label for='medium'>Medium</label></div><div class='high-priority-btn'><input type='radio' id='high' name='priority'><label for='high'>High</label></div>",n.value=e.title,d.value=e.dueDate,s&&t.replaceChild(n,s),i?t.replaceChild(d,i):n.insertAdjacentElement("afterend",d),d.insertAdjacentElement("afterend",c),d.insertAdjacentElement("beforebegin",r),t.querySelector(`input[id="${e.priority}"]`).checked=!0,c.addEventListener("click",(()=>{e.title=n.value,e.dueDate=d.value;const s=t.querySelectorAll("input[type='radio']");let i=null;s.forEach((t=>{t.checked&&(i=t.id)})),e.priority=i,this.displayTasks(this.currentProjectIndex)}))}addTaskEventListeners(t,e){const s=t.querySelector("input"),i=t.querySelector("img"),a=t.querySelector(".task-delete");s.addEventListener("change",(()=>{s.checked?(t.classList.add("completed"),e.markComplete()):(t.classList.remove("completed"),e.markIncomplete())})),i.addEventListener("click",(()=>{this.showForm(t,e)})),a.addEventListener("click",(()=>{this.toDoList.getProjects()[this.currentProjectIndex].deleteTask(e),t.remove()}))}addPageEventListeners(){this.addProjectBtn.addEventListener("click",this.createProject.bind(this)),this.basicItems.addEventListener("click",(t=>{const e=t.target.innerHTML;"Home"===e?(this.displayTasks(0),this.handleLeftPaneAnimation(0)):"Today"===e?(this.displayTasks(1),this.handleLeftPaneAnimation(1)):"This week"===e&&(this.displayTasks(2),this.handleLeftPaneAnimation(2))})),this.projectList.addEventListener("click",(t=>{if("LI"===t.target.tagName){const e=Number(t.target.dataset.index);this.displayTasks(e),this.handleLeftPaneAnimation(e)}})),this.addTaskBtn.addEventListener("click",this.createTask.bind(this))}}).loadHomePage()})();