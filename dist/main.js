(()=>{"use strict";class t{constructor(t,e,s="medium",i="incomplete"){this.title=t,this.dueDate=e,this.priority=s,this.status=i}markComplete(){this.status="completed"}markIncomplete(){this.status="incomplete"}}class e{constructor(t){this.title=t,this.tasks=[]}addTask(e){this.tasks.push(new t(e))}deleteTask(t){const e=this.tasks.indexOf(t);e>-1&&this.tasks.splice(e,1)}getTasks(){return this.tasks}}class s{constructor(){this.projects=[],this.projects.push(new e("Home")),this.projects.push(new e("Today")),this.projects.push(new e("This week"))}addProject(t){this.projects.push(new e(t))}deleteProject(t){t>-1&&this.projects.splice(t,1)}getProjects(){return this.projects}getAllTasks(){let t=[];for(let e=0;e<this.projects.length;e++)1!==e&&2!==e&&(t=t.concat(this.projects[e].getTasks()));return t}}function i(t){return i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},i(t)}function n(t,e){if(e.length<t)throw new TypeError(t+" argument"+(t>1?"s":"")+" required, but only "+e.length+" present")}function a(t){n(1,arguments);var e=Object.prototype.toString.call(t);return t instanceof Date||"object"===i(t)&&"[object Date]"===e?new Date(t.getTime()):"number"==typeof t||"[object Number]"===e?new Date(t):("string"!=typeof t&&"[object String]"!==e||"undefined"==typeof console||(console.warn("Starting with v2.0.0-beta.1 date-fns doesn't accept strings as date arguments. Please use `parseISO` to parse strings. See: https://github.com/date-fns/date-fns/blob/master/docs/upgradeGuide.md#string-arguments"),console.warn((new Error).stack)),new Date(NaN))}function r(t){n(1,arguments);var e=a(t);return e.setHours(0,0,0,0),e}var o={};function c(){return o}function d(t,e){var s,i,r,o,d,l,u,h;n(1,arguments);var p=c(),m=function(t){if(null===t||!0===t||!1===t)return NaN;var e=Number(t);return isNaN(e)?e:e<0?Math.ceil(e):Math.floor(e)}(null!==(s=null!==(i=null!==(r=null!==(o=null==e?void 0:e.weekStartsOn)&&void 0!==o?o:null==e||null===(d=e.locale)||void 0===d||null===(l=d.options)||void 0===l?void 0:l.weekStartsOn)&&void 0!==r?r:p.weekStartsOn)&&void 0!==i?i:null===(u=p.locale)||void 0===u||null===(h=u.options)||void 0===h?void 0:h.weekStartsOn)&&void 0!==s?s:0);if(!(m>=0&&m<=6))throw new RangeError("weekStartsOn must be between 0 and 6 inclusively");var k=a(t),y=k.getDay(),L=(y<m?7:0)+y-m;return k.setDate(k.getDate()-L),k.setHours(0,0,0,0),k}(new class{constructor(){this.toDoList=new s,this.currentProjectIndex=0,this.basicItems=document.querySelector(".basic-items"),this.projectList=document.querySelector(".project-list"),this.addProjectBtn=document.querySelector(".add-project-btn"),this.taskList=document.querySelector(".task-list"),this.addTaskBtn=document.querySelector(".add-task-btn")}loadHomePage(){this.displayTasks(this.currentProjectIndex),this.handleLeftPaneAnimation(this.currentProjectIndex),this.addPageEventListeners()}displayProjects(){const t=this.toDoList.getProjects();this.projectList.innerHTML="";for(let e=0;e<t.length;e++)if("Home"!==t[e].title&&"Today"!==t[e].title&&"This week"!==t[e].title){const s=document.createTextNode(t[e].title),i=document.createElement("li"),n=document.createElement("button");n.setAttribute("type","button"),n.innerHTML="X",n.classList.add("project-delete"),i.dataset.index=e,i.appendChild(s),i.appendChild(n),this.projectList.appendChild(i)}}createProject(){const t=this.projectList.querySelector(".new-project-input");if(t)return void t.focus();const e=document.createElement("input");e.setAttribute("type","text"),e.setAttribute("placeholder","Project name"),e.classList.add("new-project-input");const s=document.createElement("li");s.appendChild(e),this.projectList.appendChild(s),e.focus(),e.addEventListener("keydown",(t=>{const i=e.value.trim();if(i&&"Enter"===t.key){this.toDoList.addProject(i),this.displayProjects();const t=this.toDoList.projects.length-1;this.displayTasks(t),this.handleLeftPaneAnimation(t),s.remove()}else"Escape"===t.key&&s.remove()}))}displayTasks(t){this.currentProjectIndex=t;const e=this.toDoList.getProjects()[t],s=0===t?this.toDoList.getAllTasks():1===t?this.toDoList.getAllTasks().filter((t=>function(t){return n(1,arguments),function(t,e){n(2,arguments);var s=r(t),i=r(e);return s.getTime()===i.getTime()}(t,Date.now())}(new Date(t.dueDate)))):2===t?this.toDoList.getAllTasks().filter((t=>function(t,e){return n(1,arguments),function(t,e,s){n(2,arguments);var i=d(t,s),a=d(e,s);return i.getTime()===a.getTime()}(t,Date.now(),e)}(new Date(t.dueDate)))):e.getTasks();this.taskList.innerHTML="";for(let t=0;t<s.length;t++){const e=document.createElement("div");e.classList.add("task"),e.classList.add(`${s[t].priority}-priority`),e.classList.add(`${s[t].status}`);const i=document.createElement("input");i.setAttribute("type","checkbox"),i.classList.add("task-checkbox"),i.checked="completed"===s[t].status;const n=document.createElement("span");n.classList.add("task-name");const a=document.createTextNode(`${s[t].title}`);n.appendChild(a);const r=document.createElement("img");r.setAttribute("src","../src/images/edit.svg"),r.classList.add("task-edit");const o=document.createElement("button");o.classList.add("task-delete");const c=document.createTextNode("X");if(o.appendChild(c),e.appendChild(i),e.appendChild(n),e.appendChild(r),e.appendChild(o),s[t].dueDate){const e=document.createElement("span");e.classList.add("due-date"),e.innerHTML=s[t].dueDate,n.insertAdjacentElement("afterend",e)}this.taskList.appendChild(e),this.addTaskEventListeners(e,s[t])}1===this.currentProjectIndex|2===this.currentProjectIndex?this.addTaskBtn.classList.add("hidden"):this.addTaskBtn.classList.remove("hidden")}createTask(){const t=this.taskList.querySelector(".task-input");if(t)return void t.focus();const e=document.createElement("input");e.setAttribute("type","text"),e.setAttribute("placeholder","Task title"),e.classList.add("task-input");const s=document.createElement("div");s.appendChild(e),this.taskList.appendChild(s),e.focus(),e.addEventListener("keydown",(t=>{const i=e.value.trim();i&&"Enter"===t.key?(this.toDoList.getProjects()[this.currentProjectIndex].addTask(i),this.displayTasks(this.currentProjectIndex),s.remove()):"Escape"===t.key&&s.remove()}))}handleLeftPaneAnimation(t){document.querySelectorAll(".basic-items li, .project-list li").forEach(((e,s)=>{if(s===t){e.classList.add("active");const t=e.querySelector("button");t&&t.classList.remove("hidden")}else{e.classList.remove("active");const t=e.querySelector("button");t&&t.classList.add("hidden")}}))}showForm(t,e){const s=t.querySelector(".task-name"),i=t.querySelector(".due-date"),n=document.createElement("form"),a=document.createElement("input"),r=document.createElement("input"),o=document.createElement("button"),c=document.createElement("div");n.setAttribute("action","#"),a.setAttribute("type","text"),a.classList.add("task-edit-input"),r.setAttribute("type","date"),r.classList.add("task-date"),o.setAttribute("type","button"),o.innerHTML="Save",c.classList.add("priority-area"),c.innerHTML="<div class= 'low-priority-btn'><input type='radio' id='low' name='priority'><label for='low'>Low</label></div><div class='medium-priority-btn'><input type='radio' id='medium' name='priority'><label for='medium'>Medium</label></div><div class='high-priority-btn'><input type='radio' id='high' name='priority'><label for='high'>High</label></div>",a.value=e.title,r.value=e.dueDate,s&&t.replaceChild(a,s),i?t.replaceChild(r,i):a.insertAdjacentElement("afterend",r),r.insertAdjacentElement("afterend",o),r.insertAdjacentElement("beforebegin",c),t.querySelector(`input[id="${e.priority}"]`).checked=!0,o.addEventListener("click",(()=>{e.title=a.value,e.dueDate=r.value;const s=t.querySelectorAll("input[type='radio']");let i=null;s.forEach((t=>{t.checked&&(i=t.id)})),e.priority=i,this.displayTasks(this.currentProjectIndex)}))}addTaskEventListeners(t,e){const s=t.querySelector("input"),i=t.querySelector("img"),n=t.querySelector(".task-delete");s.addEventListener("change",(()=>{s.checked?(t.classList.add("completed"),e.markComplete()):(t.classList.remove("completed"),e.markIncomplete())})),i.addEventListener("click",(()=>{this.showForm(t,e)})),n.addEventListener("click",(()=>{this.toDoList.getProjects()[this.currentProjectIndex].deleteTask(e),t.remove()}))}addPageEventListeners(){this.addProjectBtn.addEventListener("click",this.createProject.bind(this)),this.basicItems.addEventListener("click",(t=>{const e=t.target.innerHTML;"Home"===e?(this.displayTasks(0),this.handleLeftPaneAnimation(0)):"Today"===e?(this.displayTasks(1),this.handleLeftPaneAnimation(1)):"This week"===e&&(this.displayTasks(2),this.handleLeftPaneAnimation(2))})),this.projectList.addEventListener("click",(t=>{if("LI"===t.target.tagName){const e=Number(t.target.dataset.index);this.displayTasks(e),this.handleLeftPaneAnimation(e)}else if("BUTTON"===t.target.tagName){const e=Number(t.target.parentNode.dataset.index);this.toDoList.deleteProject(e),this.displayProjects(),this.toDoList.getProjects()[e]?(this.handleLeftPaneAnimation(e),this.displayTasks(e)):(this.handleLeftPaneAnimation(e-1),this.displayTasks(e-1))}})),this.addTaskBtn.addEventListener("click",this.createTask.bind(this))}}).loadHomePage()})();